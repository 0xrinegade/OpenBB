"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[39711],{3905:(t,e,a)=>{a.d(e,{Zo:()=>d,kt:()=>u});var r=a(67294);function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e){if(null==t)return{};var a,r,n=function(t,e){if(null==t)return{};var a,r,n={},o=Object.keys(t);for(r=0;r<o.length;r++)a=o[r],e.indexOf(a)>=0||(n[a]=t[a]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)a=o[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}var s=r.createContext({}),p=function(t){var e=r.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},d=function(t){var e=p(t.components);return r.createElement(s.Provider,{value:e},t.children)},m={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},h=r.forwardRef((function(t,e){var a=t.components,n=t.mdxType,o=t.originalType,s=t.parentName,d=l(t,["components","mdxType","originalType","parentName"]),h=p(a),u=n,k=h["".concat(s,".").concat(u)]||h[u]||m[u]||o;return a?r.createElement(k,i(i({ref:e},d),{},{components:a})):r.createElement(k,i({ref:e},d))}));function u(t,e){var a=arguments,n=e&&e.mdxType;if("string"==typeof t||n){var o=a.length,i=new Array(o);i[0]=h;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=t,l.mdxType="string"==typeof t?t:n,i[1]=l;for(var p=2;p<o;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},42538:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=a(87462),n=(a(67294),a(3905));const o={title:"Portfolio Optimization",keywords:["portfolio","optimization","mean variance","risk parity","black litterman","mean risk","hierarchical clustering models"],excerpt:"The Introduction to Portfolio Optimization within the Portfolio menu explains how to use various portfolio optimization techniques and provides a brief description of its sub-menus",geekdocCollapseSection:!0},i=void 0,l={unversionedId:"guides/intros/portfolio/po",id:"guides/intros/portfolio/po",title:"Portfolio Optimization",description:"The Portfolio Optimization menu allows the user to apply advanced optimization techniques to a portfolio of any type",source:"@site/content/sdk/guides/intros/portfolio/po.md",sourceDirName:"guides/intros/portfolio",slug:"/guides/intros/portfolio/po",permalink:"/sdk/guides/intros/portfolio/po",draft:!1,editUrl:"https://github.com/OpenBB-finance/OpenBBTerminal/edit/main/website/content/sdk/guides/intros/portfolio/po.md",tags:[],version:"current",frontMatter:{title:"Portfolio Optimization",keywords:["portfolio","optimization","mean variance","risk parity","black litterman","mean risk","hierarchical clustering models"],excerpt:"The Introduction to Portfolio Optimization within the Portfolio menu explains how to use various portfolio optimization techniques and provides a brief description of its sub-menus",geekdocCollapseSection:!0},sidebar:"tutorialSidebar",previous:{title:"Portfolio",permalink:"/sdk/guides/intros/portfolio/"},next:{title:"Quantitative Analysis",permalink:"/sdk/guides/intros/quantitative-analysis"}},s={},p=[{value:"How to use",id:"how-to-use",level:2},{value:"OpenBB Parameters Template",id:"openbb-parameters-template",level:3},{value:"OpenBB Portfolio Template",id:"openbb-portfolio-template",level:3},{value:"Performing optimization",id:"performing-optimization",level:3},{value:"Examples",id:"examples",level:2}],d={toc:p};function m(t){let{components:e,...a}=t;return(0,n.kt)("wrapper",(0,r.Z)({},d,a,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"The Portfolio Optimization menu allows the user to apply advanced optimization techniques to a portfolio of any type\nand of any size. It does so by introducing a multitude of optimization techniques ranging from ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/m/meanvariance-analysis.asp",target:"_blank"},"mean-variance optimization"),"\nto ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/r/risk-parity.asp",target:"_blank"},"risk parity models")," and"),(0,n.kt)("a",{href:"https://www.investopedia.com/terms/c/cluster_analysis.asp",target:"_blank"},"hierarchical clustering models"),". By providing Excel templates, the user can make sense of the vast array of parameters that each command has. E.g. think of the historic period you wish to use or which of the more than 10 risk measures and covariance methods should be used? These are questions the templates make easier to answer.",(0,n.kt)("p",null,"The capabilities of the ",(0,n.kt)("a",{parentName:"p",href:"/terminal/guides/portfolio/po"},"Portfolio Optiminzation menu")," from the OpenBB Terminal are wrapped into a powerful SDK, enabling users to work with the data in a flexible environment that can be fully customized to meet the needs of any user. These functionalities allow the user to apply advanced optimization techniques to a portfolio of any type and of any size. It does so by introducing a multitude of optimization techniques ranging from ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/m/meanvariance-analysis.asp",target:"_blank"},"mean-variance optimization")," to ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/r/risk-parity.asp",target:"_blank"},"risk parity models")," and ",(0,n.kt)("a",{href:"https://www.investopedia.com terms/c/cluster_analysis.asp",target:"_blank"},"hierarchical clustering models"),".\nBy providing Excel templates, the user can make sense of the vast array of parameters that each command has. E.g. think of the historic period you wish to use or which of the more than 10 risk measures and covariance methods should be used? These are questions the templates make easier to answer."),(0,n.kt)("h2",{id:"how-to-use"},"How to use"),(0,n.kt)("p",null,"Start a Python script or Notebook file by importing the module:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"from openbb_terminal.sdk import openbb\n")),(0,n.kt)("p",null,"This menu requires the usage of the Excel templates to work properly. As there is a lot of complexity involved around\nthese techniques, these templates allow the user to understand what values for each parameter are actually used and\nallow for an easy way to define the allocation."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"For this there are two templates that need to be set, the ",(0,n.kt)("strong",{parentName:"p"},"OpenBB Parameters Template")," and the ",(0,n.kt)("strong",{parentName:"p"},"OpenBB Portfolio Template"),". These files can be found in the\n",(0,n.kt)("inlineCode",{parentName:"p"},"OpenBBUserData")," folder. Please see ",(0,n.kt)("a",{href:"https://openbb-finance.github.io/OpenBBTerminal/#importing-and-exporting-data-in-the-openbb-terminal",target:"_blank"},"this guide")," for how to find this folder.")),(0,n.kt)("h3",{id:"openbb-parameters-template"},"OpenBB Parameters Template"),(0,n.kt)("p",null,"This template provides the user with the ability to set define values for each parameter based on the optimization\ntechnique that is deployed. E.g. if you select ",(0,n.kt)("inlineCode",{parentName:"p"},"riskparity")," for the ",(0,n.kt)("inlineCode",{parentName:"p"},"technique")," parameter, you will notice that some\nparameters turn ",(0,n.kt)("span",{style:{color:"#BEBEBE"}},"grey"),". This means that the parameter is irrelevant for the selected\nmethod."),(0,n.kt)("p",null,"The OpenBB Terminal does, however, allow the user to run any model despite the ",(0,n.kt)("inlineCode",{parentName:"p"},"technique")," you selected. Therefore, if\nyou are interested in running multiple models, consider removing the value for ",(0,n.kt)("inlineCode",{parentName:"p"},"technique"),". Do note that this makes it\nmore difficult to understand which values are used for which model."),(0,n.kt)("a",{target:"_blank",href:"https://user-images.githubusercontent.com/46355364/171144692-dd812efd-1e95-4a71-a93f-7ae8a480fe5d.png"},(0,n.kt)("img",{alt:"OpenBB Parameters Template",src:"https://user-images.githubusercontent.com/46355364/171144692-dd812efd-1e95-4a71-a93f-7ae8a480fe5d.png"})),(0,n.kt)("p",null,"Once you have defined the parameters, save the template and load it inside the terminal by using the the following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"# Define your orderbook path here\norder_book_path = \"60_40_Portfolio.xlsx\"\n\n# Read in the file\norder_book = pd.read_excel(order_book_path)\n\n# Adjust the columns accordingly\norder_book_cols = ['Ticker', 'Asset Class', 'Sector', 'Industry', 'Country',\n       'Current Invested Amount', 'Currency']\n\norder_book = order_book[order_book_cols]\n")),(0,n.kt)("h3",{id:"openbb-portfolio-template"},"OpenBB Portfolio Template"),(0,n.kt)("p",null,"This template hands the user a format to work with it to define the portfolio. Here, categorization is applied\nbased on asset class, sector, industry, country and currency. By using the dropdown menus within this Excel, you\nare able to apply the proper categorization. This is based on the same methodology as found in other areas of the\nterminal."),(0,n.kt)("a",{target:"_blank",href:"https://user-images.githubusercontent.com/46355364/171145061-cd618153-801c-4771-ba57-7ee0ab8c57e8.png"},(0,n.kt)("img",{alt:"OpenBB Portfolio Template",src:"https://user-images.githubusercontent.com/46355364/171145061-cd618153-801c-4771-ba57-7ee0ab8c57e8.png"})),(0,n.kt)("p",null,"You can load in the portfolio template with the following code:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"import pandas as pd\n\n# Define your own orderbook path here, current value won't work\norder_book_path = \"60_40_Portfolio.xlsx\"\n\n# Read in the file\norder_book = pd.read_excel(order_book_path)\n\n# Adjust the columns accordingly\norder_book_cols = ['Ticker', 'Asset Class', 'Sector', 'Industry', 'Country',\n       'Current Invested Amount', 'Currency']\n\norder_book = order_book[order_book_cols]\n\n# Load in the portfolio\ntickers, categories = openbb.portfolio.po.load(order_book_path)\n")),(0,n.kt)("h3",{id:"performing-optimization"},"Performing optimization"),(0,n.kt)("p",null,"Based on the parameters and allocation the user has set, the optimization process begins. What optimization\ntechnique is ideal depends entirely on the user's risk profile and objectives. As an illustration,"),(0,n.kt)("a",{href:"https://www.investopedia.com/terms/r/risk-parity.asp",target:"_blank"},"Risk Parity"),"is presented below:",(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"# Perform calculations\nweights_riskparity, data_returns_riskparity = openbb.portfolio.po.riskparity(tickers)\n\n# Convert to a DataFrame\npd.DataFrame.from_dict(weights_riskparity, orient='index', columns=[\"Risk Parity\"])\n")),(0,n.kt)("p",null,"Which returns:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"}),(0,n.kt)("th",{parentName:"tr",align:"right"},"Risk Parity"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AAPL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.0462")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AMZN"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04545")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"APTV"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.03177")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ASML"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.03328")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"BABA"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04192")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GOOGL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04758")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"HYG"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.13093")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"NKE"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04909")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TIP"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.30826")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TLT"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.21927")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TSM"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04626")))),(0,n.kt)("p",null,"It is possible to use the commands without loading in the parameters template or by using the parameters template but\nchanging some arguments directly into the terminal. For example, using the same method as described above, the risk\nmeasure is changed to ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/c/conditional_value_at_risk.asp",target:"_blank"},"Conditional Value at Risk (CVaR)"),"\nand the used historic period is increased to 10 years (keeping all other parameters unchanged):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},'weights_riskparity, data_returns_riskparity = openbb.portfolio.po.riskparity(tickers, interval="10y", risk_measure="CVaR")\n')),(0,n.kt)("p",null,"Which returns:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"}),(0,n.kt)("th",{parentName:"tr",align:"right"},"Risk Parity"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AAPL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04843")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AMZN"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04302")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"APTV"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.03907")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ASML"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.03717")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"GOOGL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04877")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"HYG"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.14643")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"NKE"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.05275")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TIP"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.33264")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TLT"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.20371")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"TSM"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.04802")))),(0,n.kt)("h2",{id:"examples"},"Examples"),(0,n.kt)("p",null,"To demonstrate the capabilities of the Portfolio Optimization menu, the entire ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/s/sp500.asp",target:"_blank"},"S&P 500 index")," (as of 30th of May 2022)\nis used and optimized and analysed in a variety of ways. Starting by loading in the dataset with the following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"import pandas as pd\n\n# Define your own orderbook path here, current value won't work\norder_book_path = \"SP_500_Portfolio.xlsx\"\n\n# Read in the file\norder_book = pd.read_excel(order_book_path)\n\n# Adjust the columns accordingly\norder_book_cols = ['Ticker', 'Asset Class', 'Sector', 'Industry', 'Country',\n       'Current Invested Amount', 'Currency']\n\norder_book = order_book[order_book_cols]\n\n# Load in the portfolio\ntickers, categories = openbb.portfolio.po.load(order_book_path)\n")),(0,n.kt)("p",null,"Then, the ",(0,n.kt)("a",{href:"https://jpm.pm-research.com/content/42/4/59.short",target:"_blank"},"Hierarchical Risk Parity")," technique is applied by using the following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},'weights_hrp, data_returns_hrp = openbb.portfolio.po.hrp(\n    tickers,\n    interval="5y",\n    risk_measure="cVaR",\n    risk_aversion=0.8\n)\n\npd.DataFrame.from_dict(weights_hrp, orient=\'index\', columns=["Hierarchical Risk Parity"])\n')),(0,n.kt)("p",null,"This results in the following (the result is edited, as it would show 500 tickers, to prevent flooding this page):"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"}),(0,n.kt)("th",{parentName:"tr",align:"right"},"Hierarchical Risk Parity"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"A"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00199")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AAL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00104")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AAP"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00185")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"AAPL"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00184")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ABBV"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.0028")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"..."),(0,n.kt)("td",{parentName:"tr",align:"right"},"...")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"NOC"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00228")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"XOM"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00167")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ZBRA"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00156")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ZION"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.0014")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"ZTS"),(0,n.kt)("td",{parentName:"tr",align:"right"},"0.00225")))),(0,n.kt)("p",null,"It is possible to delve further into these findings with the ",(0,n.kt)("inlineCode",{parentName:"p"},"plot")," functionality for example done by looking at the portfolio's returns ",(0,n.kt)("a",{href:"https://www.investopedia.com/terms/h/histogram.asp",target:"_blank"},"histogram"),"\nwhich also includes a variety of risk measures as well as the portfolio's drawdowns."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"openbb.portfolio.po.plot(data=data_returns_hrp, weights=weights_hrp, risk_measure='cVaR', hist=True)\n")),(0,n.kt)("a",{target:"_blank",href:"https://user-images.githubusercontent.com/46355364/171145848-5a3f5333-6b7f-4d7a-a96e-0859adb1ce78.png"},(0,n.kt)("img",{alt:"Portfokio Returns Histogram",src:"https://user-images.githubusercontent.com/46355364/171145848-5a3f5333-6b7f-4d7a-a96e-0859adb1ce78.png"})),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"openbb.portfolio.po.plot(data=data_returns_hrp, weights=weights_hrp, risk_measure='cVaR', dd=True)\n")),(0,n.kt)("a",{target:"_blank",href:"https://user-images.githubusercontent.com/46355364/171145983-2d2c1c2e-67d2-4839-b43a-51bd22332de8.png"},(0,n.kt)("img",{alt:"Portfolio Drawdowns",src:"https://user-images.githubusercontent.com/46355364/171145983-2d2c1c2e-67d2-4839-b43a-51bd22332de8.png"})))}m.isMDXComponent=!0}}]);